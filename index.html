<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Portal</title>
    
    <link rel="manifest" href="data:application/manifest+json;base64,ewogICJuYW1lIjogIkVtcGxveWVlIFBvcnRhbCIsCiAgInNob3J0X25hbWUiOiAiUG9ydGFsIiwKICAic3RhcnRfdXJsIjogIi4iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiMwYTBlMWEiLAogICJ0aGVtZV9jb2xvciI6ICIjMzMwMGNjIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiaHR0cHM6Ly9jZG4taWNvbnMtcG5nLmZsYXRpY29uLmNvbS81MTIvMTgyNy8xODI3MzQ3LnBuZyIsCiAgICAgICJzaXplcyI6ICI1MTJ4NTEyIiwKICAgICAgInR5cGUiOiAiaW1hZ2UvcG5nIgogICAgfQogIF0KfQ==">

    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background-color: #0a0e1a; }
        iframe { border: none; width: 100%; height: 100%; }
    </style>
</head>
<body>
    
    <iframe src="https://script.google.com/macros/s/AKfycbwpaXjVKwhuJ0YcpoT5531CvxfevHrPcHqUlKuwwkMOZsTj1-zVlljdeYZ1r2SuURky/exec"></iframe>

    <script>
        let deferredPrompt;

        // 2. ഇൻസ്റ്റാൾ പോപ്പ്-അപ്പ് കാണിക്കാനുള്ള ലോജിക്
        window.addEventListener('beforeinstallprompt', (e) => {
            // ബ്രൗസറിന്റെ ഡിഫോൾട്ട് രീതി തടയുന്നു
            e.preventDefault();
            deferredPrompt = e;

            // യൂസർ ലിങ്ക് തുറന്ന് 3 സെക്കന്റിന് ശേഷം പോപ്പ്-അപ്പ് കാണിക്കുന്നു
            setTimeout(() => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((choiceResult) => {
                        if (choiceResult.outcome === 'accepted') {
                            console.log('User accepted the install prompt');
                        }
                        deferredPrompt = null;
                    });
                }
            }, 3000); 
        });

        // 3. സർവീസ് വർക്കർ രജിസ്റ്റർ ചെയ്യുന്നു (ഇൻസ്റ്റാൾ ചെയ്യാൻ ഇത് നിർബന്ധമാണ്)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('data:text/javascript;base64,c2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZXZlbnQgPT4gewogIHNlbGYuc2tpcFdhaXRpbmcoKTsKfSk7CnNlbGYuYWRkRXZlbnRMaXN0ZW5lcignYWN0aXZhdGUnLCBldmVudCA9PiB7CiAgc2VsZi5jbGllbnRzLmNsYWltKCk7Cn0pOw==');
            });
        }
    </script>
</body>
</html>
